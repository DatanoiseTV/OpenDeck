{
    "version": "2.0.0",
    "tasks": [
        {
            "label": "[FW/BTLDR] Build",
            "command": "compiledb -d . make TARGETNAME=${input:target} LANG=C",
            "type": "shell",
            "problemMatcher": [
                "$gcc"
            ],
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "windows": {
                "options": {
                    "shell": {
                        //needed on windows since tasks don't source .bashrc profile
                        // >> therefore any modifications to PATH aren't available
                        "executable": "C://WINDOWS//System32//wsl.exe",
                        "args": [
                           "PATH=/usr/local/avr/bin:~/.local/bin:${PATH}",
                           "MAKEFLAGS=-j8"
                        ]
                    }
                }
            }
        },
        {
            "label": "[FW/BTLDR] Clean",
            "command": "make clean",
            "type": "shell",
            "problemMatcher": [],
            "windows": {
                "options": {
                    "shell": {
                        //needed on windows since tasks don't source .bashrc profile
                        // >> therefore any modifications to PATH aren't available
                        "executable": "C://WINDOWS//System32//wsl.exe",
                        "args": [
                           "PATH=/usr/local/avr/bin:~/.local/bin:${PATH}",
                        ]
                    }
                }
            }
        },
        {
            "label": "[Tests] Build",
            "command": "cd tests && make pre-build && make TESTS=${input:test} && cp build/${input:test}.out build/test.out",
            "type": "shell",
            "problemMatcher": [
                "$gcc"
            ],
            "windows": {
                "options": {
                    "shell": {
                        //needed on windows since tasks don't source .bashrc profile
                        // >> therefore any modifications to PATH aren't available
                        "executable": "C://WINDOWS//System32//wsl.exe",
                        "args": [
                           "PATH=/usr/local/avr/bin:~/.local/bin:${PATH}",
                           "MAKEFLAGS=-j8"
                        ]
                    }
                }
            }
        },
        {
            "label": "[Tests] Clean",
            "command": "cd tests && make clean",
            "type": "shell",
            "problemMatcher": [],
            "windows": {
                "options": {
                    "shell": {
                        //needed on windows since tasks don't source .bashrc profile
                        // >> therefore any modifications to PATH aren't available
                        "executable": "C://WINDOWS//System32//wsl.exe",
                        "args": [
                           "PATH=/usr/local/avr/bin:~/.local/bin:${PATH}",
                        ]
                    }
                }
            }
        },
        {
            "label": "[Tests] Run compiled",
            "command": "cd tests && make exec",
            "type": "shell",
            "problemMatcher": [],
            "windows": {
                "options": {
                    "shell": {
                        //needed on windows since tasks don't source .bashrc profile
                        // >> therefore any modifications to PATH aren't available
                        "executable": "C://WINDOWS//System32//wsl.exe",
                        "args": [
                           "PATH=/usr/local/avr/bin:~/.local/bin:${PATH}",
                        ]
                    }
                }
            }
        },
        {
            "label": "[VSCode] Update intellisense",
            "command": "../scripts/vscode_intellisense.sh ${input:target}",
            "type": "shell",
            "problemMatcher": [],
            "windows": {
                "options": {
                    "shell": {
                        //needed on windows since tasks don't source .bashrc profile
                        // >> therefore any modifications to PATH aren't available
                        "executable": "C://WINDOWS//System32//wsl.exe",
                        "args": [
                           "PATH=/usr/local/avr/bin:~/.local/bin:${PATH}",
                           "MAKEFLAGS=-j8"
                        ]
                    }
                }
            }
        }
    ],
    "inputs": [
        {
            "id": "target",
            "type": "pickString",
            "default": "fw_opendeck",
            "description": "Select target for which to build:",
            "options": [
                "fw_opendeck",
                "fw_leonardo",
                "fw_mega",
                "fw_pro_micro",
                "fw_uno",
                "fw_teensy2pp",
                "fw_dubfocus",
                "fw_bergamot",
                "fw_16u2",
                "fw_8u2",
                "fw_mega6mux",
                "boot_opendeck",
                "boot_leonardo",
                "boot_pro_micro",
                "boot_mega",
                "boot_uno",
                "boot_teensy2pp",
                "boot_dubfocus",
                "boot_bergamot",
                "boot_16u2 VARIANT=VARIANT_MEGA",
                "boot_16u2 VARIANT=VARIANT_UNO"
            ]
        },
        {
            "id": "test",
            "type": "pickString",
            "default": "database",
            "description": "Select test to build:",
            "options": [
                "database",
                "encoders",
                "pots",
                "buttons",
                "ringbuf",
                "odmidi"
            ]
        }
    ]
}